{
  "name": "market-data | end-to-end (bronze \u2192 silver \u2192 gold generic rules_v1 snapshot)",
  "max_concurrent_runs": 1,
  "tasks": [
    {
      "task_key": "bronze_ingest",
      "description": "Ingest raw market bars into bronze_market_bars_raw (micro-batch).",
      "notebook_task": {
        "notebook_path": "/Repos/<YOUR_REPO_PATH>/01-ingestion-bronze/notebooks/ingest_market_bars",
        "base_parameters": {
          "config_path": "dbfs:/FileStore/market-data/config/bronze.json"
        }
      },
      "job_cluster_key": "md_job_cluster",
      "timeout_seconds": 3600,
      "max_retries": 2,
      "min_retry_interval_millis": 60000,
      "retry_on_timeout": true
    },
    {
      "task_key": "silver_bars",
      "description": "Transform bronze_market_bars_raw into silver_market_bars.",
      "depends_on": [
        {
          "task_key": "bronze_ingest"
        }
      ],
      "notebook_task": {
        "notebook_path": "/Repos/<YOUR_REPO_PATH>/02-transformation-silver/notebooks/transform_silver_market_bars",
        "base_parameters": {
          "config_path": "dbfs:/FileStore/market-data/config/silver.json"
        }
      },
      "job_cluster_key": "md_job_cluster",
      "timeout_seconds": 3600,
      "max_retries": 2,
      "min_retry_interval_millis": 60000,
      "retry_on_timeout": true
    },
    {
      "task_key": "silver_features",
      "description": "Compute silver_market_features from silver_market_bars.",
      "depends_on": [
        {
          "task_key": "silver_bars"
        }
      ],
      "notebook_task": {
        "notebook_path": "/Repos/<YOUR_REPO_PATH>/02-transformation-silver/notebooks/transform_silver_market_features",
        "base_parameters": {
          "config_path": "dbfs:/FileStore/market-data/config/silver.json"
        }
      },
      "job_cluster_key": "md_job_cluster",
      "timeout_seconds": 3600,
      "max_retries": 2,
      "min_retry_interval_millis": 60000,
      "retry_on_timeout": true
    },
    {
      "task_key": "gold_rules_v1",
      "description": "Build gold_trend_rules (rules_v1 baseline, generic intervals).",
      "depends_on": [
        {
          "task_key": "silver_features"
        }
      ],
      "notebook_task": {
        "notebook_path": "/Repos/<YOUR_REPO_PATH>/03-serving-gold-generic/notebooks/build_gold_trend_rules",
        "base_parameters": {
          "config_path": "dbfs:/FileStore/market-data/config/gold_rules_v1_generic.json"
        }
      },
      "job_cluster_key": "md_job_cluster",
      "timeout_seconds": 3600,
      "max_retries": 2,
      "min_retry_interval_millis": 60000,
      "retry_on_timeout": true
    },
    {
      "task_key": "gold_ml_stub",
      "description": "Refresh gold_trend_ml (empty stub / reserved contract).",
      "depends_on": [
        {
          "task_key": "gold_rules_v1"
        }
      ],
      "notebook_task": {
        "notebook_path": "/Repos/<YOUR_REPO_PATH>/03-serving-gold-generic/notebooks/build_gold_trend_ml_stub",
        "base_parameters": {
          "config_path": "dbfs:/FileStore/market-data/config/gold_rules_v1_generic.json"
        }
      },
      "job_cluster_key": "md_job_cluster",
      "timeout_seconds": 1800,
      "max_retries": 0
    },
    {
      "task_key": "gold_snapshot",
      "description": "Build gold_signal_snapshot (decision-ready, generic intervals).",
      "depends_on": [
        {
          "task_key": "gold_ml_stub"
        }
      ],
      "notebook_task": {
        "notebook_path": "/Repos/<YOUR_REPO_PATH>/03-serving-gold-generic/notebooks/build_gold_signal_snapshot",
        "base_parameters": {
          "config_path": "dbfs:/FileStore/market-data/config/gold_rules_v1_generic.json"
        }
      },
      "job_cluster_key": "md_job_cluster",
      "timeout_seconds": 3600,
      "max_retries": 2,
      "min_retry_interval_millis": 60000,
      "retry_on_timeout": true
    }
  ],
  "job_clusters": [
    {
      "job_cluster_key": "md_job_cluster",
      "new_cluster": {
        "spark_version": "<DATABRICKS_RUNTIME_VERSION>",
        "node_type_id": "<NODE_TYPE>",
        "num_workers": 2,
        "data_security_mode": "SINGLE_USER",
        "spark_conf": {
          "spark.databricks.delta.optimizeWrite.enabled": "true",
          "spark.databricks.delta.autoCompact.enabled": "true"
        }
      }
    }
  ],
  "schedule": {
    "quartz_cron_expression": "0 0/5 * * * ?",
    "timezone_id": "UTC",
    "pause_status": "PAUSED"
  },
  "tags": {
    "project": "market-data-trend-lakehouse",
    "pipeline": "end-to-end",
    "gold_mode": "generic",
    "signal_version": "rules_v1"
  }
}